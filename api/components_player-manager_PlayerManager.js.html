<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>components/player-manager/PlayerManager.js - como</title>
    
    <meta name="description" content="Documentation of the como framework" />
    
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <link type="text/css" rel="stylesheet" href="styles/overrides.css">
    <script src="scripts/nav.js" defer></script>
    
    
    <link rel="icon" href="/como/favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    
    
        <h2 class="home">
            <a href="index.html" style="background-image: url('/como/logo-200x200.png')">
                Home
            </a>
        </h2>
    <h2><a href="../" class="menu-item" >Website</a></h2><h2><a href="https://github.com/ircam-ismm/como" target="_blank" class="menu-item" >Github</a></h2><h3>Classes</h3><ul><li><a href="ComoClient.html">ComoClient</a><ul class='members'><li data-type='member' style='display: none;'><a href="ComoClient.html#audioBufferLoader">audioBufferLoader</a></li><li data-type='member' style='display: none;'><a href="ComoClient.html#audioContext">audioContext</a></li><li data-type='member' style='display: none;'><a href="ComoClient.html#audioScheduler">audioScheduler</a></li><li data-type='member' style='display: none;'><a href="ComoClient.html#components">components</a></li><li data-type='member' style='display: none;'><a href="ComoClient.html#host">host</a></li><li data-type='member' style='display: none;'><a href="ComoClient.html#id">id</a></li><li data-type='member' style='display: none;'><a href="ComoClient.html#keyValueStore">keyValueStore</a></li><li data-type='member' style='display: none;'><a href="ComoClient.html#nodeId">nodeId</a></li><li data-type='member' style='display: none;'><a href="ComoClient.html#playerManager">playerManager</a></li><li data-type='member' style='display: none;'><a href="ComoClient.html#pluginManager">pluginManager</a></li><li data-type='member' style='display: none;'><a href="ComoClient.html#projectManager">projectManager</a></li><li data-type='member' style='display: none;'><a href="ComoClient.html#role">role</a></li><li data-type='member' style='display: none;'><a href="ComoClient.html#runtime">runtime</a></li><li data-type='member' style='display: none;'><a href="ComoClient.html#scheduler">scheduler</a></li><li data-type='member' style='display: none;'><a href="ComoClient.html#scriptManager">scriptManager</a></li><li data-type='member' style='display: none;'><a href="ComoClient.html#sessionManager">sessionManager</a></li><li data-type='member' style='display: none;'><a href="ComoClient.html#soundbankManager">soundbankManager</a></li><li data-type='member' style='display: none;'><a href="ComoClient.html#sourceManager">sourceManager</a></li><li data-type='member' style='display: none;'><a href="ComoClient.html#stateManager">stateManager</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="ComoClient.html#init">init</a></li><li data-type='method' style='display: none;'><a href="ComoClient.html#requestRfc">requestRfc</a></li><li data-type='method' style='display: none;'><a href="ComoClient.html#setProject">setProject</a></li><li data-type='method' style='display: none;'><a href="ComoClient.html#setRfcHandler">setRfcHandler</a></li><li data-type='method' style='display: none;'><a href="ComoClient.html#setRfcResolverHook">setRfcResolverHook</a></li><li data-type='method' style='display: none;'><a href="ComoClient.html#start">start</a></li><li data-type='method' style='display: none;'><a href="ComoClient.html#stop">stop</a></li></ul></li><li><a href="ComoNode.html">ComoNode</a><ul class='members'><li data-type='member' style='display: none;'><a href="ComoNode.html#audioBufferLoader">audioBufferLoader</a></li><li data-type='member' style='display: none;'><a href="ComoNode.html#audioContext">audioContext</a></li><li data-type='member' style='display: none;'><a href="ComoNode.html#audioScheduler">audioScheduler</a></li><li data-type='member' style='display: none;'><a href="ComoNode.html#components">components</a></li><li data-type='member' style='display: none;'><a href="ComoNode.html#host">host</a></li><li data-type='member' style='display: none;'><a href="ComoNode.html#id">id</a></li><li data-type='member' style='display: none;'><a href="ComoNode.html#nodeId">nodeId</a></li><li data-type='member' style='display: none;'><a href="ComoNode.html#pluginManager">pluginManager</a></li><li data-type='member' style='display: none;'><a href="ComoNode.html#role">role</a></li><li data-type='member' style='display: none;'><a href="ComoNode.html#runtime">runtime</a></li><li data-type='member' style='display: none;'><a href="ComoNode.html#scheduler">scheduler</a></li><li data-type='member' style='display: none;'><a href="ComoNode.html#stateManager">stateManager</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="ComoNode.html#init">init</a></li><li data-type='method' style='display: none;'><a href="ComoNode.html#requestRfc">requestRfc</a></li><li data-type='method' style='display: none;'><a href="ComoNode.html#setProject">setProject</a></li><li data-type='method' style='display: none;'><a href="ComoNode.html#setRfcHandler">setRfcHandler</a></li><li data-type='method' style='display: none;'><a href="ComoNode.html#setRfcResolverHook">setRfcResolverHook</a></li><li data-type='method' style='display: none;'><a href="ComoNode.html#start">start</a></li><li data-type='method' style='display: none;'><a href="ComoNode.html#stop">stop</a></li></ul></li><li><a href="ComoServer.html">ComoServer</a><ul class='members'><li data-type='member' style='display: none;'><a href="ComoServer.html#audioBufferLoader">audioBufferLoader</a></li><li data-type='member' style='display: none;'><a href="ComoServer.html#audioContext">audioContext</a></li><li data-type='member' style='display: none;'><a href="ComoServer.html#audioScheduler">audioScheduler</a></li><li data-type='member' style='display: none;'><a href="ComoServer.html#components">components</a></li><li data-type='member' style='display: none;'><a href="ComoServer.html#host">host</a></li><li data-type='member' style='display: none;'><a href="ComoServer.html#id">id</a></li><li data-type='member' style='display: none;'><a href="ComoServer.html#keyValueStore">keyValueStore</a></li><li data-type='member' style='display: none;'><a href="ComoServer.html#nodeId">nodeId</a></li><li data-type='member' style='display: none;'><a href="ComoServer.html#playerManager">playerManager</a></li><li data-type='member' style='display: none;'><a href="ComoServer.html#pluginManager">pluginManager</a></li><li data-type='member' style='display: none;'><a href="ComoServer.html#projectManager">projectManager</a></li><li data-type='member' style='display: none;'><a href="ComoServer.html#role">role</a></li><li data-type='member' style='display: none;'><a href="ComoServer.html#runtime">runtime</a></li><li data-type='member' style='display: none;'><a href="ComoServer.html#scheduler">scheduler</a></li><li data-type='member' style='display: none;'><a href="ComoServer.html#scriptManager">scriptManager</a></li><li data-type='member' style='display: none;'><a href="ComoServer.html#sessionManager">sessionManager</a></li><li data-type='member' style='display: none;'><a href="ComoServer.html#soundbankManager">soundbankManager</a></li><li data-type='member' style='display: none;'><a href="ComoServer.html#sourceManager">sourceManager</a></li><li data-type='member' style='display: none;'><a href="ComoServer.html#stateManager">stateManager</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="ComoServer.html#init">init</a></li><li data-type='method' style='display: none;'><a href="ComoServer.html#requestRfc">requestRfc</a></li><li data-type='method' style='display: none;'><a href="ComoServer.html#setProject">setProject</a></li><li data-type='method' style='display: none;'><a href="ComoServer.html#setRfcHandler">setRfcHandler</a></li><li data-type='method' style='display: none;'><a href="ComoServer.html#setRfcResolverHook">setRfcResolverHook</a></li><li data-type='method' style='display: none;'><a href="ComoServer.html#start">start</a></li><li data-type='method' style='display: none;'><a href="ComoServer.html#stop">stop</a></li></ul></li><li><a href="KeyValueStore.html">KeyValueStore</a><ul class='methods'><li data-type='method' style='display: none;'><a href="KeyValueStore.html#clear">clear</a></li><li data-type='method' style='display: none;'><a href="KeyValueStore.html#delete">delete</a></li><li data-type='method' style='display: none;'><a href="KeyValueStore.html#get">get</a></li><li data-type='method' style='display: none;'><a href="KeyValueStore.html#set">set</a></li></ul></li><li><a href="KeyValueStoreClient.html">KeyValueStoreClient</a><ul class='methods'><li data-type='method' style='display: none;'><a href="KeyValueStoreClient.html#clear">clear</a></li><li data-type='method' style='display: none;'><a href="KeyValueStoreClient.html#delete">delete</a></li><li data-type='method' style='display: none;'><a href="KeyValueStoreClient.html#get">get</a></li><li data-type='method' style='display: none;'><a href="KeyValueStoreClient.html#set">set</a></li></ul></li><li><a href="KeyValueStoreServer.html">KeyValueStoreServer</a><ul class='methods'><li data-type='method' style='display: none;'><a href="KeyValueStoreServer.html#clear">clear</a></li><li data-type='method' style='display: none;'><a href="KeyValueStoreServer.html#delete">delete</a></li><li data-type='method' style='display: none;'><a href="KeyValueStoreServer.html#get">get</a></li><li data-type='method' style='display: none;'><a href="KeyValueStoreServer.html#set">set</a></li></ul></li><li><a href="Player.html">Player</a><ul class='members'><li data-type='member' style='display: none;'><a href="Player.html#id">id</a></li><li data-type='member' style='display: none;'><a href="Player.html#nodeId">nodeId</a></li><li data-type='member' style='display: none;'><a href="Player.html#source">source</a></li><li data-type='member' style='display: none;'><a href="Player.html#state">state</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="Player.html#delete">delete</a></li><li data-type='method' style='display: none;'><a href="Player.html#setScript">setScript</a></li></ul></li><li><a href="PlayerManager.html">PlayerManager</a><ul class='members'><li data-type='member' style='display: none;'><a href="PlayerManager.html#players">players</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="PlayerManager.html#createPlayer">createPlayer</a></li><li data-type='method' style='display: none;'><a href="PlayerManager.html#getPlayer">getPlayer</a></li><li data-type='method' style='display: none;'><a href="PlayerManager.html#getPlayerState">getPlayerState</a></li><li data-type='method' style='display: none;'><a href="PlayerManager.html#getScriptSharedState">getScriptSharedState</a></li><li data-type='method' style='display: none;'><a href="PlayerManager.html#playerExists">playerExists</a></li></ul></li><li><a href="PlayerManagerClient.html">PlayerManagerClient</a><ul class='members'><li data-type='member' style='display: none;'><a href="PlayerManagerClient.html#players">players</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="PlayerManagerClient.html#createPlayer">createPlayer</a></li><li data-type='method' style='display: none;'><a href="PlayerManagerClient.html#getPlayer">getPlayer</a></li><li data-type='method' style='display: none;'><a href="PlayerManagerClient.html#getPlayerState">getPlayerState</a></li><li data-type='method' style='display: none;'><a href="PlayerManagerClient.html#getScriptSharedState">getScriptSharedState</a></li><li data-type='method' style='display: none;'><a href="PlayerManagerClient.html#playerExists">playerExists</a></li></ul></li><li><a href="ScriptManager.html">ScriptManager</a><ul class='methods'><li data-type='method' style='display: none;'><a href="ScriptManager.html#attach">attach</a></li><li data-type='method' style='display: none;'><a href="ScriptManager.html#getCollection">getCollection</a></li><li data-type='method' style='display: none;'><a href="ScriptManager.html#getList">getList</a></li><li data-type='method' style='display: none;'><a href="ScriptManager.html#onUpdate">onUpdate</a></li></ul></li><li><a href="ScriptManagerClient.html">ScriptManagerClient</a><ul class='methods'><li data-type='method' style='display: none;'><a href="ScriptManagerClient.html#attach">attach</a></li><li data-type='method' style='display: none;'><a href="ScriptManagerClient.html#getCollection">getCollection</a></li><li data-type='method' style='display: none;'><a href="ScriptManagerClient.html#getList">getList</a></li><li data-type='method' style='display: none;'><a href="ScriptManagerClient.html#onUpdate">onUpdate</a></li></ul></li><li><a href="ScriptManagerServer.html">ScriptManagerServer</a><ul class='methods'><li data-type='method' style='display: none;'><a href="ScriptManagerServer.html#attach">attach</a></li><li data-type='method' style='display: none;'><a href="ScriptManagerServer.html#getCollection">getCollection</a></li><li data-type='method' style='display: none;'><a href="ScriptManagerServer.html#getList">getList</a></li><li data-type='method' style='display: none;'><a href="ScriptManagerServer.html#onUpdate">onUpdate</a></li></ul></li><li><a href="SessionManager.html">SessionManager</a><ul class='members'><li data-type='member' style='display: none;'><a href="SessionManager.html#sessions">sessions</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="SessionManager.html#createSession">createSession</a></li><li data-type='method' style='display: none;'><a href="SessionManager.html#deleteSession">deleteSession</a></li><li data-type='method' style='display: none;'><a href="SessionManager.html#getSession">getSession</a></li><li data-type='method' style='display: none;'><a href="SessionManager.html#getSessionBus">getSessionBus</a></li><li data-type='method' style='display: none;'><a href="SessionManager.html#getSessionSoundbank">getSessionSoundbank</a></li><li data-type='method' style='display: none;'><a href="SessionManager.html#persistSession">persistSession</a></li><li data-type='method' style='display: none;'><a href="SessionManager.html#renameSession">renameSession</a></li></ul></li><li><a href="SessionManagerClient.html">SessionManagerClient</a><ul class='members'><li data-type='member' style='display: none;'><a href="SessionManagerClient.html#sessions">sessions</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="SessionManagerClient.html#createSession">createSession</a></li><li data-type='method' style='display: none;'><a href="SessionManagerClient.html#deleteSession">deleteSession</a></li><li data-type='method' style='display: none;'><a href="SessionManagerClient.html#getSession">getSession</a></li><li data-type='method' style='display: none;'><a href="SessionManagerClient.html#getSessionBus">getSessionBus</a></li><li data-type='method' style='display: none;'><a href="SessionManagerClient.html#getSessionSoundbank">getSessionSoundbank</a></li><li data-type='method' style='display: none;'><a href="SessionManagerClient.html#persistSession">persistSession</a></li><li data-type='method' style='display: none;'><a href="SessionManagerClient.html#renameSession">renameSession</a></li></ul></li><li><a href="SessionManagerServer.html">SessionManagerServer</a><ul class='members'><li data-type='member' style='display: none;'><a href="SessionManagerServer.html#sessions">sessions</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="SessionManagerServer.html#createSession">createSession</a></li><li data-type='method' style='display: none;'><a href="SessionManagerServer.html#deleteSession">deleteSession</a></li><li data-type='method' style='display: none;'><a href="SessionManagerServer.html#getSession">getSession</a></li><li data-type='method' style='display: none;'><a href="SessionManagerServer.html#getSessionBus">getSessionBus</a></li><li data-type='method' style='display: none;'><a href="SessionManagerServer.html#getSessionSoundbank">getSessionSoundbank</a></li><li data-type='method' style='display: none;'><a href="SessionManagerServer.html#persistSession">persistSession</a></li><li data-type='method' style='display: none;'><a href="SessionManagerServer.html#renameSession">renameSession</a></li></ul></li><li><a href="SoundbankManager.html">SoundbankManager</a><ul class='methods'><li data-type='method' style='display: none;'><a href="SoundbankManager.html#getBuffer">getBuffer</a></li><li data-type='method' style='display: none;'><a href="SoundbankManager.html#getBuffers">getBuffers</a></li><li data-type='method' style='display: none;'><a href="SoundbankManager.html#getTreeAsUrlMap">getTreeAsUrlMap</a></li><li data-type='method' style='display: none;'><a href="SoundbankManager.html#onUpdate">onUpdate</a></li></ul></li><li><a href="SoundbankManagerClient.html">SoundbankManagerClient</a><ul class='methods'><li data-type='method' style='display: none;'><a href="SoundbankManagerClient.html#getBuffer">getBuffer</a></li><li data-type='method' style='display: none;'><a href="SoundbankManagerClient.html#getBuffers">getBuffers</a></li><li data-type='method' style='display: none;'><a href="SoundbankManagerClient.html#getTreeAsUrlMap">getTreeAsUrlMap</a></li><li data-type='method' style='display: none;'><a href="SoundbankManagerClient.html#onUpdate">onUpdate</a></li></ul></li><li><a href="SoundbankManagerServer.html">SoundbankManagerServer</a><ul class='methods'><li data-type='method' style='display: none;'><a href="SoundbankManagerServer.html#getBuffer">getBuffer</a></li><li data-type='method' style='display: none;'><a href="SoundbankManagerServer.html#getBuffers">getBuffers</a></li><li data-type='method' style='display: none;'><a href="SoundbankManagerServer.html#getTreeAsUrlMap">getTreeAsUrlMap</a></li><li data-type='method' style='display: none;'><a href="SoundbankManagerServer.html#onUpdate">onUpdate</a></li></ul></li><li><a href="SourceManager.html">SourceManager</a><ul class='members'><li data-type='member' style='display: none;'><a href="SourceManager.html#list">list</a></li><li data-type='member' style='display: none;'><a href="SourceManager.html#sources">sources</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="SourceManager.html#createSource">createSource</a></li><li data-type='method' style='display: none;'><a href="SourceManager.html#deleteRecording">deleteRecording</a></li><li data-type='method' style='display: none;'><a href="SourceManager.html#deleteSource">deleteSource</a></li><li data-type='method' style='display: none;'><a href="SourceManager.html#getSource">getSource</a></li><li data-type='method' style='display: none;'><a href="SourceManager.html#getSourceFiltered">getSourceFiltered</a></li><li data-type='method' style='display: none;'><a href="SourceManager.html#listRecordings">listRecordings</a></li><li data-type='method' style='display: none;'><a href="SourceManager.html#readRecording">readRecording</a></li><li data-type='method' style='display: none;'><a href="SourceManager.html#sourceExists">sourceExists</a></li></ul></li><li><a href="SourceManagerClient.html">SourceManagerClient</a><ul class='members'><li data-type='member' style='display: none;'><a href="SourceManagerClient.html#list">list</a></li><li data-type='member' style='display: none;'><a href="SourceManagerClient.html#sources">sources</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="SourceManagerClient.html#createSource">createSource</a></li><li data-type='method' style='display: none;'><a href="SourceManagerClient.html#deleteRecording">deleteRecording</a></li><li data-type='method' style='display: none;'><a href="SourceManagerClient.html#deleteSource">deleteSource</a></li><li data-type='method' style='display: none;'><a href="SourceManagerClient.html#getSource">getSource</a></li><li data-type='method' style='display: none;'><a href="SourceManagerClient.html#getSourceFiltered">getSourceFiltered</a></li><li data-type='method' style='display: none;'><a href="SourceManagerClient.html#listRecordings">listRecordings</a></li><li data-type='method' style='display: none;'><a href="SourceManagerClient.html#readRecording">readRecording</a></li><li data-type='method' style='display: none;'><a href="SourceManagerClient.html#sourceExists">sourceExists</a></li></ul></li><li><a href="SourceManagerServer.html">SourceManagerServer</a><ul class='members'><li data-type='member' style='display: none;'><a href="SourceManagerServer.html#list">list</a></li><li data-type='member' style='display: none;'><a href="SourceManagerServer.html#sources">sources</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="SourceManagerServer.html#createSource">createSource</a></li><li data-type='method' style='display: none;'><a href="SourceManagerServer.html#deleteRecording">deleteRecording</a></li><li data-type='method' style='display: none;'><a href="SourceManagerServer.html#deleteSource">deleteSource</a></li><li data-type='method' style='display: none;'><a href="SourceManagerServer.html#getSource">getSource</a></li><li data-type='method' style='display: none;'><a href="SourceManagerServer.html#getSourceFiltered">getSourceFiltered</a></li><li data-type='method' style='display: none;'><a href="SourceManagerServer.html#listRecordings">listRecordings</a></li><li data-type='method' style='display: none;'><a href="SourceManagerServer.html#readRecording">readRecording</a></li><li data-type='method' style='display: none;'><a href="SourceManagerServer.html#sourceExists">sourceExists</a></li></ul></li><li><a href="module.exports.html">module.exports</a><ul class='members'><li data-type='member' style='display: none;'><a href="module.exports.html#players">players</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="module.exports.html#createPlayer">createPlayer</a></li><li data-type='method' style='display: none;'><a href="module.exports.html#getPlayer">getPlayer</a></li><li data-type='method' style='display: none;'><a href="module.exports.html#getPlayerState">getPlayerState</a></li><li data-type='method' style='display: none;'><a href="module.exports.html#getScriptSharedState">getScriptSharedState</a></li><li data-type='method' style='display: none;'><a href="module.exports.html#playerExists">playerExists</a></li></ul></li></ul>
    
</nav>

<div id="main">
    
    <h1 class="page-title">components/player-manager/PlayerManager.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import {
  isString,
} from '@ircam/sc-utils';

import ComoComponent from '../../core/ComoComponent.js';
import Player from './Player.js';

/**
 * The PlayerManager is responsible for the management of the players, which are
 * themselves defined as a link between a {@link ComoSource} and a {@link ComoScript}.
 *
 * The player manager gives access to the list of existing players, can create
 * full featured Player or mirrors of existing one (i.e. duplicate a player instance
 * on another node of the network)
 *
 * @see {@link Player}
 */
class PlayerManager extends ComoComponent {
  #ownedPlayers = new Set();
  #players; // collection of player states

  /**
   * @hideconstructor
   * @param {ComoNode} como
   * @param {String} name
   */
  constructor(como, name) {
    super(como, name);

    if (!this.como.sourceManager) {
      throw new Error(`Cannot construct PlayerManager: relies on 'como.sourceManager'`);
    }

    if (!this.como.scriptManager) {
      throw new Error(`Cannot construct PlayerManager: relies on 'como.scriptManager'`);
    }

    if (!this.como.sessionManager) {
      throw new Error(`Cannot construct PlayerManager: relies on 'como.sessionManager'`);
    }

    this.como.setRfcHandler(`${this.name}:createPlayer`, this.#createPlayer);
  }

  /**
   * The living collection of all players underlying shared states.
   *
   * @return {SharedStateCollection}
   */
  get players() {
    return this.#players;
  }

  /** @private */
  async start() {
    await super.start();

    this.#players = await this.como.stateManager.getCollection(`${this.name}:player`);
  }

  /**
   * Returns wether the player exists on the network
   *
   * @param {String} playerId
   * @returns {Boolean}
   */
  playerExists(playerId) {
    return !!this.players.find(player => player.get('id') === playerId);
  }

  /**
   * Create a player on a given {@link ComoNode}.
   *
   * @param {String} sourceId - Id of the source
   * @param {Object} [options]
   * @param {String} [options.nodeId=this.como.nodeId] - Optional id of the {@link ComoNode} where
   *  the player should be created, defaults to the node where the function is called
   * @param {String} [options.id=null] - Optional user-defined id to assign
   *  to the player. _Important: that for now this is the responsibility of the client code
   *  to ensure the ids remain unique across the network._
   * @returns {String} Id of the player
   */
  async createPlayer(sourceId, {
    nodeId = this.como.nodeId,
    id = null,
  }) {
    if (!this.como.sourceManager.sourceExists(sourceId)) {
      throw new Error(`Cannot execute "createPlayer" on PlayerManager: source with id ("${sourceId}") does not exists`);
    }

    return await this.como.requestRfc(nodeId, `${this.name}:createPlayer`, {
      sourceId,
      id,
    });
  }

  /** @private */
  #createPlayer = async ({ sourceId, id  }) => {
    const player = new Player(this.como, sourceId, id );
    await player.init();

    this.#ownedPlayers.add(player);

    return player.id;
  }

  /**
   * @todo - Implement
   * @private
   */
  async deletePlayer(playerId) {

  }

      // attach to exiting script shared state, if any, rather than creating a new instance
  /**
   * Get the full {@link Player} API access of a given player.
   *
   * If called on another {@link ComoNode}, ``getPlayerthis`` basically creates
   * a clone of the original player. Useful for example to duplicate the audio
   * of a node on another node.
   *
   * @param {String} playerId
   * @returns {Player|null}
   */
  async getPlayer(playerId) {
    if (!isString(playerId)) {
      throw new Error(`Cannot execute "getPlayer" on PlayerManager: argument 1 ("${playerId}") is not a string`);
    }

    const owned = Array.from(this.#ownedPlayers).find(player => player.id === playerId);

    if (owned) {
      return owned;
    }

    const notOwned = this.players.find(player => player.get('id') === playerId);

    if (notOwned) {
      const player = new Player(this.como, notOwned.get('sourceId'));
      await player.init(notOwned); // init with attached state from the collection
      return player;
    }

    return null;
  }

  /**
   * Get the underlying state of a player without the full {{@link Player} logic
   * and behavior.
   *
   * @param {String} playerId
   * @returns {Player|null}
   */
  async getPlayerState(playerId) {
    const player = this.players.find(player => player.get('id') === playerId);
    return player || null;
  }

  /**
   * Return the SharedState associated to the script assigned to the given player.
   *
   * Return null if the player is not associated to a script, or if the associated
   * script does not define a shared state.
   *
   * @param {String} playerId
   * @returns {SharedState|null}
   */
  async getScriptSharedState(playerId) {
    const player = this.players.find(player => player.get('id') === playerId);

    if (!player) {
      throw new Error(`Cannot execute "getScriptSharedState" on PlayerManager: player (${playerId}) does not exist`);
    }

    const scriptSharedStateClassName = player.get('scriptSharedStateClassName');
    const scriptSharedStateId = player.get('scriptSharedStateId');

    if (scriptSharedStateClassName !== null) {
      const scriptState = await this.como.stateManager.attach(
        scriptSharedStateClassName,
        scriptSharedStateId
      );

      return scriptState;
    }

    return null;
  }

}

export default PlayerManager;
</code></pre>
        </article>
    </section>





    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.5</a> on Fri Feb 20 2026 09:27:27 GMT+0000 (Coordinated Universal Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>


<script src="scripts/collapse.js" defer></script>


</body>
</html>
